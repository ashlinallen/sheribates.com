(function(b){var c=window.$window||b(window),a=window.extra||{};b.fn.extraSlider=function(d){var e=b.extend({auto:false,draggable:false,keyboard:false,margin:0,navigate:true,paginate:true,paginateContent:"",resizable:true,speed:0.5,type:"slide",onInit:null,onMoveStart:null,onMoveEnd:null,onUpdate:null,onUpdateClones:null,onPause:null,onResume:null},d);this.each(function(){var p=b(this),A=b("> .wrapper",this),F=A.find("> ul"),k=F.find("> li"),l=0,z=p.find(".navigation"),t=p.find(".pagination"),y=0,w=0,J=k.length-1,g=-1,h=y,s=0,D=J,m=0,B=0,v,j,C,o=0,G;function E(){if(s>J){s=0;}else{if(s<0){s=J;}}var i=-(h*(s)+(l*y));TweenMax.set(F,{css:{left:i}});}function f(K){var i=0,L,M;k.each(function(){L=b(this);M=(K==="height")?L.outerHeight(true):L.outerWidth(true);if(M>i){i=M;}});return i;}function n(K,i){if(e.type==="slide"){E();if(e.draggable&&e.type==="slide"&&C!==undefined){Draggable.get(F).enable();}}else{if(e.type==="fade"&&i.length){TweenMax.set(i,{autoAlpha:0});}}k.eq(s+l).addClass("active");if(e.onMoveEnd&&K>0){e.onMoveEnd(k.eq(s+l),J+1,p);}p.trigger("moveEnd.extra.slider",[k.eq(s+l),J+1,p]);}function H(K,M){M=(M!==undefined)?M:e.speed;var i=K<s?-1:1,N,L;k.removeClass("active");if(!TweenMax.isTweening(F)&&!TweenMax.isTweening(k)){D=s;s=parseInt(K,10);if(e.type==="fade"){if(s>J){s=0;}else{if(s<0){s=J;}}}N=s;if(N>J){N=0;}else{if(N<0){N=J;}}if(e.onMoveStart&&M>0){e.onMoveStart(k.eq(N+l),J+1,p);}p.trigger("moveStart.extra.slider",[k.eq(N+l),J+1,p]);if(e.paginate){t.find("a").removeClass("active").eq(N).addClass("active");}switch(e.type){case"slide":L=-(h*(s)+(l*y));if(m!==0){if(s>J){L+=y*m;}if(s<0){L-=y*m;}}TweenMax.to(F,M,{css:{left:L},onComplete:n,onCompleteParams:[M]});break;case"fade":k.eq(D).css("zIndex",1);TweenMax.to(k.eq(s).css("zIndex",2),M,{css:{autoAlpha:1},onComplete:n,onCompleteParams:[M,k.eq(D)]});break;}}}function u(){var i;F.css("width","");k.css("width","").css("height","");A.css("width","").css("height","");y=f("width");w=f("height");h=y*g;i=Math.max(1,Math.floor(A.width()/y));if(i!==g){g=i;J=Math.floor((k.not(".cloned").length-1)/g);m=Math.abs((J+1)*g-(k.not(".cloned").length));if(e.type=="slide"){x();}u();return false;}k.css({width:y+"px",height:w+"px"});A.css({width:h+"px",height:w+"px"});if(e.type=="slide"){E();F.width(99999);}k.removeClass("active");k.eq(s+l).addClass("active");if(e.onUpdate){e.onUpdate(k.eq(s+l),J+1,p);}p.trigger("update.extra.slider",[k.eq(s+l),J+1,p]);}function x(){k.find(".cloned").remove();k.first().before(k.slice(-(g+e.margin+m)).clone(true).addClass("cloned"));k.last().after(k.slice(0,g+e.margin+m).clone(true).addClass("cloned"));k=F.find("> li");l=k.filter(".cloned").size()/2||0;if(e.onUpdateClones){e.onUpdateClones(k.eq(s+l),J+1,p);}p.trigger("updateClones.extra.slider",[k.eq(s+l),J+1,p]);}function r(i){i=(i!==undefined)?i:e.speed;H(s+1,i);}function q(i){i=i!==undefined?i:e.speed;H(s-1,i);}function I(){j=TweenMax.delayedCall(e.auto,function(){r();I();});}k.each(function(i,K){b(this).data("index",i);});y=f("width");w=f("height");switch(e.type){case"slide":p.addClass("extra-slider-slide");break;case"fade":p.addClass("extra-slider-fade");k.each(function(K){if(K===s){TweenMax.set(b(this),{css:{autoAlpha:1,zIndex:2}});}else{TweenMax.set(b(this),{css:{autoAlpha:0,zIndex:1}});}});break;}b(this).on("update",function(){u();});b(this).on("next",function(i,K){r(K);});b(this).on("prev",function(i,K){q(K);});b(this).on("goto",function(i,K,L){L=L!==undefined?L:e.speed;H(K,L);});if(e.resizable){v=a.resizeEvent!==undefined?a.resizeEvent:"resize";c.on(v,function(){u();});}if(e.navigate){if(!z.length){z=b('<div class="navigation"><a href="#" class="prev">Previous</a><a href="#" class="next">Next</a></div>').insertAfter(A);}b("a.prev",z).click(function(){q();return false;});b("a.next",z).click(function(){r();return false;});}if(e.paginate){if(!t.length){t=b('<div class="pagination"></div>').insertAfter(A);}if(e.paginateContent!=""){}for(B=0;B<=J;B+=1){b("<a>",{href:"#"}).html(e.paginateContent!==""?e.paginateContent.replace("%d",(B+1)):B+1).appendTo(t);}t.find("a").removeClass("active").eq(s).addClass("active");b("a",t).each(function(K){b(this).click(function(){if(!b(this).hasClass("active")){H(K);}return false;});});}if(e.keyboard){c.on("keydown",function(i){if(i.which===39){r();}if(i.which===37){q();}});}if(!isNaN(e.auto)&&e.auto>0){I();p.on("mouseenter pause",function(){if(e.onPause){e.onPause(p);}p.trigger("pause.extra.slider",[p]);j.pause();}).on("mouseleave resume",function(){if(e.onResume){e.onResume(p);}p.trigger("resume.extra.slider",[p]);j.resume();});}if(e.draggable&&e.type==="slide"){p.addClass("extra-slider-draggable");if(Draggable!==undefined){C=Draggable.create(F,{dragClickables:true,type:"left",cursor:"move",onDragStart:function(){p.addClass("extra-slider-mouse-down");o=parseFloat(F.css("left"));},onDragEnd:function(){Draggable.get(F).disable();G=((o-this.x)>0)?-1:1;p.removeClass("extra-slider-mouse-down");if(G===1){q();}else{r();}}});}else{console.log("Draggable is not detected. You need to load it to enable drag. More info here : http://www.greensock.com/draggable/");}}u();c.load(function(){u();});if(e.onInit){e.onInit(k.eq(s+l),J+1,p);}p.trigger("init.extra.slider",[k.eq(s+l),J+1,p]);});return this;};}(jQuery));